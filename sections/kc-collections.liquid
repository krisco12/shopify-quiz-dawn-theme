{{ 'kc-collection.css' | asset_url | stylesheet_tag }}

<div class="kc-collections-section" id="kc-collections-{{ section.id }}">
  <div class="container">
    {%- if section.settings.heading != blank -%}
      <h2 class="kc-collections-heading text-center">{{ section.settings.heading }}</h2>
    {%- endif -%}

    {%- if section.settings.description != blank -%}
      <p class="kc-collections-description text-center">{{ section.settings.description }}</p>
    {%- endif -%}

    <div class="kc-collections-grid">
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when 'collection' -%}
            {%- liquid
              assign collection = collections[block.settings.collection]
            -%}
            
            {%- if collection != blank -%}
              <div class="kc-collection-card" {{ block.shopify_attributes }}>
                <a href="{{ collection.url }}" class="kc-collection-link">
                  <div class="kc-collection-image">
                    {%- if collection.image != blank -%}
                      <img
                        src="{{ collection.image | image_url: width: 600 }}"
                        srcset="{{ collection.image | image_url: width: 300 }} 300w,
                                {{ collection.image | image_url: width: 600 }} 600w,
                                {{ collection.image | image_url: width: 900 }} 900w"
                        sizes="(min-width: 1024px) 33vw, (min-width: 768px) 50vw, 100vw"
                        alt="{{ collection.image.alt | escape }}"
                        loading="lazy"
                        width="{{ collection.image.width }}"
                        height="{{ collection.image.height }}"
                      >
                    {%- else -%}
                      <div class="kc-collection-placeholder">
                        {{ 'collection-1' | placeholder_svg_tag: 'placeholder-svg' }}
                      </div>
                    {%- endif -%}
                  </div>
                  
                  <div class="kc-collection-content">
                    <h3 class="kc-collection-title">{{ collection.title }}</h3>
                    {%- if block.settings.show_description and collection.description != blank -%}
                      <p class="kc-collection-excerpt">{{ collection.description | strip_html | truncate: 120 }}</p>
                    {%- endif -%}
                    {%- if block.settings.show_count -%}
                      <p class="kc-collection-count">{{ collection.products_count }} {% if collection.products_count == 1 %}product{% else %}products{% endif %}</p>
                    {%- endif -%}
                    <span class="btn btn-outline btn-sm">Shop Now</span>
                  </div>
                </a>
              </div>
            {%- endif -%}
        {%- endcase -%}
      {%- endfor -%}
    </div>

    {%- if section.settings.show_view_all -%}
      <div class="kc-collections-footer text-center">
        <a href="/collections" class="btn btn-primary">View All Collections</a>
      </div>
    {%- endif -%}
  </div>
</div>

{% schema %}
{
  "name": "KC Collections",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Shop by Category"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Explore our curated collections designed for men with ADHD"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show 'View All' button",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "checkbox",
          "id": "show_description",
          "label": "Show collection description",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_count",
          "label": "Show product count",
          "default": true
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "KC Collections",
      "blocks": [
        {
          "type": "collection"
        },
        {
          "type": "collection"
        },
        {
          "type": "collection"
        }
      ]
    }
  ]
}
{% endschema %}

